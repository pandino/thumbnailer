<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Thumbnailer - Slideshow</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body class="slideshow-page">
    <div class="slideshow-container">
        <div class="slideshow-header">
            <a href="/" class="back-button">‚Üê Back to Control</a>
            <div class="slideshow-info">
                <span class="movie-title">{{.Thumbnail.MovieFilename}}</span>
                <span class="slideshow-counter">Thumbnail {{.Current}} of {{.Total}} <span class="random-indicator">Random Order</span></span>
                {{if eq .Thumbnail.Status "deleted"}}
                <span class="deletion-status">Deleted</span>
                {{else if .PendingDelete}}
                <span class="deletion-status pending">Pending Deletion (Press U to Undo)</span>
                {{end}}
            </div>
            <div class="slideshow-actions">
                {{if .IsLastThumbnail}}
                <form action="/slideshow/delete-and-finish" method="post" id="delete-form">
                    <button type="submit" class="action-icon-button danger" title="Delete movie and finish slideshow" {{if or (eq .Thumbnail.Status "deleted") .PendingDelete}}disabled{{end}}>
                        <span class="action-icon">üóëÔ∏è</span>
                    </button>
                </form>
                {{else}}
                <form action="/slideshow/delete" method="post" id="delete-form">
                    <button type="submit" class="action-icon-button danger" title="Delete movie" {{if or (eq .Thumbnail.Status "deleted") .PendingDelete}}disabled{{end}}>
                        <span class="action-icon">üóëÔ∏è</span>
                    </button>
                </form>
                {{end}}
            </div>
        </div>

        <div class="thumbnail-display">
            {{if eq .Thumbnail.Source "imported"}}
            <div class="source-badge imported">Imported</div>
            {{end}}
            <img src="/thumbnails/{{.Thumbnail.ThumbnailPath}}" alt="{{.Thumbnail.MovieFilename}}" 
                class="thumbnail-image {{if or (eq .Thumbnail.Status "deleted") .PendingDelete}}pending-deletion{{end}} {{.Thumbnail.Source}}">>
        </div>

        <div class="movie-details">
            <div class="detail-item">
                <span class="detail-label">Duration:</span>
                <span class="detail-value">{{.Thumbnail.GetDurationFormatted}}</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">Resolution:</span>
                <span class="detail-value">{{.Thumbnail.GetResolution}}</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">File Size:</span>
                <span class="detail-value">{{.Thumbnail.GetFileSizeFormatted}}</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">Created:</span>
                <span class="detail-value">{{.Thumbnail.CreatedAt.Format "Jan 02, 2006 15:04:05"}}</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">Source:</span>
                <span class="detail-value source-badge {{.Thumbnail.Source}}">{{.Thumbnail.Source}}</span>
            </div>
        </div>

        <div class="slideshow-nav">
            <a href="/slideshow/previous" 
            class="nav-button undo{{if not .HasPrevious}} disabled{{end}}"
            {{if not .HasPrevious}}onclick="return false;"{{end}}
            title="Undo last action">
                Undo
            </a>
            
            {{if .IsLastThumbnail}}
            <a href="/slideshow/finish" class="nav-button finish" title="Mark as viewed and finish slideshow">
                Finish
            </a>
            {{else}}
            <a href="/slideshow/next" class="nav-button next" title="Mark as viewed and go to next random thumbnail">
                Next
            </a>
            {{end}}
        </div>

        <div class="keyboard-shortcuts">
            <p>
                <span class="shortcut-group">
                    <span class="shortcut">‚Üí</span> or <span class="shortcut">Space</span>: 
                    {{if .IsLastThumbnail}}
                    <span class="shortcut-value">Finish (Mark as Viewed)</span>
                    {{else}}
                    <span class="shortcut-value">Next Random (Mark as Viewed)</span>
                    {{end}}
                </span>
                
                <span class="shortcut-group">
                    <span class="shortcut">U</span>: 
                    {{if .PendingDelete}}
                    <span class="shortcut-value">Undo Delete</span>
                    {{else if .HasPrevious}}
                    <span class="shortcut-value">Undo</span>
                    {{else}}
                    <span class="shortcut-disabled">Undo (No history)</span>
                    {{end}}
                </span>
                
                <span class="shortcut-group">
                    <span class="shortcut">D</span>: 
                    {{if .PendingDelete}}
                    <span class="shortcut-disabled">Delete (Pending)</span>
                    {{else if .IsLastThumbnail}}
                    <span class="shortcut-value">Delete & Finish</span>
                    {{else}}
                    <span class="shortcut-value">Delete</span>
                    {{end}}
                </span>
                
                <span class="shortcut-group">
                    <span class="shortcut">S</span>: 
                    <span class="shortcut-value">Skip</span>
                </span>
                
                <span class="shortcut-group">
                    <span class="shortcut">Esc</span>: 
                    <span class="shortcut-value">Back to control</span>
                </span>
            </p>
        </div>
    </div>

    <script src="/static/js/slideshow.js"></script>
</body>
</html>
